# 更新日志

## [0.3.0] - 2025-10-10

### 🚨 重大变更 - 破坏性更改

#### 强制使用 define_model! 宏
- **不再支持动态表结构推断**：所有数据库操作现在必须使用 `define_model!` 宏预定义模型
- **修复重大架构Bug**：消除了动态推断导致的"保姆设置"问题，避免不可预期的字段类型推断
- **提升类型安全**：要求明确指定字段类型、约束和索引，提供更强的类型安全保障
- **自动表创建行为变更**：如果表不存在且没有预定义模型，现在会抛出错误而不是自动推断创建

#### 迁移要求
- **必须迁移**：所有使用旧动态推断方式的代码必须迁移到 `define_model!` 宏
- **查看迁移指南**：请参考 `MIGRATION_GUIDE_0_3_0.md` 进行详细迁移
- **示例更新**：所有使用旧方式的示例已重命名为 `.deprecated.rs`，请参考新的示例文件

### 架构改进
- 重构适配器层：使用FieldDefinition替换FieldType以支持更完整的字段定义
- 优化PostgreSQL适配器，添加表创建锁防止重复创建
- 改进MySQL/SQLite/MongoDB适配器的模型元数据获取逻辑
- 优化查询构建器，过滤NULL值以支持数据库默认值

### 文档和示例
- 新增 `MIGRATION_GUIDE_0_3_0.md` 详细迁移指南
- 将过期示例重命名为 `.deprecated.rs` 避免用户误用
- 保留核心业务示例使用正确的 `define_model!` 宏

### 修复
- 修复PostgreSQL适配器初始化问题
- 修复查询构建器中NULL值处理逻辑
- 改进表创建的双重检查锁定模式

### 删除
- 移除过时的Python API构建器模块

## [0.2.5] - 2025-10-10 (已跳过，直接升级到0.3.0)

> **注意**：0.2.5版本已跳过，直接发布0.3.0重大版本

### 重构
- 重构适配器层：使用FieldDefinition替换FieldType以支持更完整的字段定义
- 优化Python集成桥接层，移除过时的解析器和异步处理器
- 简化模型绑定系统，提高性能和可维护性

### 修复
- 修复Python API中的队列桥接逻辑
- 更新依赖项版本以修复兼容性问题

### 内部改进
- 改进代码结构和模块组织
- 更新文档和注释

## [0.2.4] - 2025-10-10

### 修复
- 修复所有示例文件中DatabaseOperation::Create缺少id_strategy字段的问题
- 完成ID策略修复和架构安全改进

## [0.2.3] - 2025-10-09

### 新增
- 添加多版本缓存支持
- 实现编码感知的缓存键生成
- 添加预压缩和版本选择策略

### 改进
- 优化缓存性能
- 增强数据库连接管理

## [0.2.2] - 2025-10-08

### 修复
- 修复连接池管理问题
- 解决内存泄漏问题

## [0.2.1] - 2025-10-07

### 新增
- 添加Python绑定支持
- 实现跨数据库查询构建器

### 改进
- 优化异步性能
- 增强错误处理

## [0.2.0] - 2025-10-06

### 重大更新
- 完全重构的ODM核心
- 支持MongoDB、PostgreSQL、MySQL、SQLite
- 添加自动索引创建
- 实现统一查询接口

### 新增
- 现代异步架构
- 强类型模型定义
- 灵活的查询构建器
- 内置缓存支持

---

## 版本说明

- **主版本 (Major)**：不兼容的API更改
- **次版本 (Minor)**：向后兼容的功能添加
- **修订版本 (Patch)**：向后兼容的错误修复